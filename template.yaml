#tags: ['cbg-5', 'chromeos', 'cros-codecs']

actions:
- deploy:
    namespace: cros-codecs
    kernel:
      url: https://storage.chromeos.kernelci.org/images/kernel/cros---chromeos-6.1-x86_64-chromiumos-x86_64.flavour.config+x86-chromebook/clang-14/kernel/bzImage
    modules:
      compression: xz
      url: https://storage.chromeos.kernelci.org/images/kernel/cros---chromeos-6.1-x86_64-chromiumos-x86_64.flavour.config+x86-chromebook/clang-14/modules.tar.xz
    nfsrootfs:
      compression: xz
      url: https://people.collabora.com/~detlev/cros-codecs-tests/full.rootfs.tar.xz
    os: oe
    ramdisk:
      compression: gz
      url: https://people.collabora.com/~detlev/cros-codecs-tests/initrd.cpio.gz
    timeout:
      minutes: 15
    to: tftp
- boot:
    namespace: modules
    commands: nfs
    method: depthcharge
    namespace: cros-codecs
    prompts:
    - '/ #'
    timeout:
      minutes: 5
- test:
    definitions:
       - repository: https://github.com/cazou/cros-codecs-tests.git
         branch: 'main'
         history: False
         from: git
         name: run_fluster
         path: test-cases/cros-codecs.yaml
       - repository: https://github.com/cazou/cros-codecs-tests.git
         branch: 'main'
         history: False
         from: git
         name: run_fluster_single
         path: test-cases/cros-codecs-single.yaml
    namespace: cros-codecs
    timeout:
      minutes: 120

context:
  extra_kernel_args: console_msg_format=syslog earlycon
#device_type: acer-R721T-grunt
device_type: acer-cp514-2h-1160g7-volteer
job_name: test-cros-codecs-debug

priority: medium
timeouts:
  action:
    minutes: 120
  actions:
    power-off:
      seconds: 30
  job:
    minutes: 120
  queue:
    days: 2
visibility: public
